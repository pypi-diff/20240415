# Comparing `tmp/lense-0.0.1-py3-none-any.whl.zip` & `tmp/lense-0.0.21-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,14 +1,14 @@
-Zip file size: 9629 bytes, number of entries: 12
+Zip file size: 7874 bytes, number of entries: 12
 -rw-rw-rw-  2.0 fat       24 b- defN 24-Apr-11 09:48 lense/__init__.py
--rw-rw-rw-  2.0 fat      289 b- defN 24-Apr-11 07:23 lense/app.py
--rw-rw-rw-  2.0 fat        0 b- defN 24-Apr-11 06:48 lense/_data_load/__init__.py
--rw-rw-rw-  2.0 fat     1089 b- defN 24-Apr-11 07:07 lense/_data_load/cglense.py
--rw-rw-rw-  2.0 fat     6904 b- defN 24-Apr-11 06:48 lense/_data_load/engine.py
--rw-rw-rw-  2.0 fat    10973 b- defN 24-Apr-11 06:48 lense/_data_load/error_handling.py
--rw-rw-rw-  2.0 fat     4139 b- defN 24-Apr-11 09:45 lense/_data_load/loader.py
--rw-rw-rw-  2.0 fat      519 b- defN 24-Apr-11 06:48 lense/_data_load/replace_file.py
--rw-rw-rw-  2.0 fat      858 b- defN 24-Apr-11 10:12 lense-0.0.1.dist-info/METADATA
--rw-rw-rw-  2.0 fat       92 b- defN 24-Apr-11 10:12 lense-0.0.1.dist-info/WHEEL
--rw-rw-rw-  2.0 fat        6 b- defN 24-Apr-11 10:12 lense-0.0.1.dist-info/top_level.txt
--rw-rw-r--  2.0 fat      940 b- defN 24-Apr-11 10:12 lense-0.0.1.dist-info/RECORD
-12 files, 25833 bytes uncompressed, 8051 bytes compressed:  68.8%
+-rw-rw-rw-  2.0 fat      455 b- defN 24-Apr-15 12:02 lense/app.py
+-rw-rw-rw-  2.0 fat        0 b- defN 24-Apr-11 06:48 lense/_chat/__init__.py
+-rw-rw-rw-  2.0 fat     1173 b- defN 24-Apr-15 11:44 lense/_chat/cglense.py
+-rw-rw-rw-  2.0 fat     6653 b- defN 24-Apr-15 11:55 lense/_chat/engine.py
+-rw-rw-rw-  2.0 fat     4850 b- defN 24-Apr-15 11:45 lense/_chat/error_handling.py
+-rw-rw-rw-  2.0 fat     4179 b- defN 24-Apr-15 11:48 lense/_chat/loader.py
+-rw-rw-rw-  2.0 fat      519 b- defN 24-Apr-15 11:45 lense/_chat/replace_file.py
+-rw-rw-rw-  2.0 fat      654 b- defN 24-Apr-15 12:05 lense-0.0.21.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       92 b- defN 24-Apr-15 12:05 lense-0.0.21.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat        6 b- defN 24-Apr-15 12:05 lense-0.0.21.dist-info/top_level.txt
+-rw-rw-r--  2.0 fat      913 b- defN 24-Apr-15 12:05 lense-0.0.21.dist-info/RECORD
+12 files, 19518 bytes uncompressed, 6348 bytes compressed:  67.5%
```

## zipnote {}

```diff
@@ -1,37 +1,37 @@
 Filename: lense/__init__.py
 Comment: 
 
 Filename: lense/app.py
 Comment: 
 
-Filename: lense/_data_load/__init__.py
+Filename: lense/_chat/__init__.py
 Comment: 
 
-Filename: lense/_data_load/cglense.py
+Filename: lense/_chat/cglense.py
 Comment: 
 
-Filename: lense/_data_load/engine.py
+Filename: lense/_chat/engine.py
 Comment: 
 
-Filename: lense/_data_load/error_handling.py
+Filename: lense/_chat/error_handling.py
 Comment: 
 
-Filename: lense/_data_load/loader.py
+Filename: lense/_chat/loader.py
 Comment: 
 
-Filename: lense/_data_load/replace_file.py
+Filename: lense/_chat/replace_file.py
 Comment: 
 
-Filename: lense-0.0.1.dist-info/METADATA
+Filename: lense-0.0.21.dist-info/METADATA
 Comment: 
 
-Filename: lense-0.0.1.dist-info/WHEEL
+Filename: lense-0.0.21.dist-info/WHEEL
 Comment: 
 
-Filename: lense-0.0.1.dist-info/top_level.txt
+Filename: lense-0.0.21.dist-info/top_level.txt
 Comment: 
 
-Filename: lense-0.0.1.dist-info/RECORD
+Filename: lense-0.0.21.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## lense/app.py

```diff
@@ -1,12 +1,19 @@
-from lense._data_load.loader import load_document , load_folder
-
+from lense._chat.loader import load_document
+from lense._chat.engine import embed_and_run
+import os
+import pandas as pd
+import pickle
 
 class lense:
     def __init__(self):
-        pass
-    def load_data(self, filename):
-        return (load_document(filename))
+        self._var = []
+    
+    def load_document(self,filename):
+        self._var=  (load_document(filename))
+        pickle.dump(self._var,open("result","wb"))
     
-    def load_folder(self,foldername):
-        return (load_folder(foldername))
+    def chat(self):
+        var = pickle.load(open("result","rb"))
+        embed_and_run(var)
+
```

## Comparing `lense/_data_load/engine.py` & `lense/_chat/engine.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,432 +1,416 @@
-00000000: 0d0a 6465 6620 656d 6265 645f 616e 645f  ..def embed_and_
-00000010: 7275 6e5f 6d69 7374 7261 6c28 646f 6375  run_mistral(docu
-00000020: 6d65 6e74 7329 3a0d 0a20 2020 2066 726f  ments):..    fro
-00000030: 6d20 6c61 6e67 6368 6169 6e2e 6c6c 6d73  m langchain.llms
-00000040: 2069 6d70 6f72 7420 4875 6767 696e 6746   import HuggingF
-00000050: 6163 6548 7562 0d0a 2020 2020 6672 6f6d  aceHub..    from
-00000060: 206c 616e 6763 6861 696e 2e65 6d62 6564   langchain.embed
-00000070: 6469 6e67 732e 6875 6767 696e 6766 6163  dings.huggingfac
-00000080: 6520 696d 706f 7274 2048 7567 6769 6e67  e import Hugging
-00000090: 4661 6365 456d 6265 6464 696e 6773 0d0a  FaceEmbeddings..
-000000a0: 2020 2020 6672 6f6d 206c 6c61 6d61 5f69      from llama_i
-000000b0: 6e64 6578 2e63 6f72 6520 696d 706f 7274  ndex.core import
-000000c0: 2056 6563 746f 7253 746f 7265 496e 6465   VectorStoreInde
-000000d0: 780d 0a20 2020 2072 6570 6f5f 6964 203d  x..    repo_id =
-000000e0: 2022 6d69 7374 7261 6c61 692f 4d69 7374   "mistralai/Mist
-000000f0: 7261 6c2d 3742 2d49 6e73 7472 7563 742d  ral-7B-Instruct-
-00000100: 7630 2e32 220d 0a20 2020 206c 6c6d 203d  v0.2"..    llm =
-00000110: 2048 7567 6769 6e67 4661 6365 4875 6228   HuggingFaceHub(
-00000120: 6875 6767 696e 6766 6163 6568 7562 5f61  huggingfacehub_a
-00000130: 7069 5f74 6f6b 656e 3d27 6866 5f66 5643  pi_token='hf_fVC
-00000140: 4363 4d41 4859 4746 5277 6159 694c 554c  CcMAHYGFRwaYiLUL
-00000150: 746e 6e51 446b 416e 6155 6d6e 6651 4c27  tnnQDkAnaUmnfQL'
-00000160: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00000170: 2020 2020 2020 2020 2020 2072 6570 6f5f             repo_
-00000180: 6964 3d72 6570 6f5f 6964 2c20 6d6f 6465  id=repo_id, mode
-00000190: 6c5f 6b77 6172 6773 3d7b 2274 656d 7065  l_kwargs={"tempe
-000001a0: 7261 7475 7265 223a 302e 352c 2022 6d61  rature":0.5, "ma
-000001b0: 785f 6e65 775f 746f 6b65 6e73 223a 3130  x_new_tokens":10
-000001c0: 307d 290d 0a0d 0a20 2020 2065 6d62 6564  0})....    embed
-000001d0: 5f6d 6f64 656c 203d 2048 7567 6769 6e67  _model = Hugging
-000001e0: 4661 6365 456d 6265 6464 696e 6773 286d  FaceEmbeddings(m
-000001f0: 6f64 656c 5f6e 616d 653d 2273 656e 7465  odel_name="sente
-00000200: 6e63 652d 7472 616e 7366 6f72 6d65 7273  nce-transformers
-00000210: 2f61 6c6c 2d6d 706e 6574 2d62 6173 652d  /all-mpnet-base-
-00000220: 7632 2229 0d0a 2020 2020 696e 6465 7820  v2")..    index 
-00000230: 3d20 5665 6374 6f72 5374 6f72 6549 6e64  = VectorStoreInd
-00000240: 6578 2e66 726f 6d5f 646f 6375 6d65 6e74  ex.from_document
-00000250: 7328 646f 6375 6d65 6e74 732c 2065 6d62  s(documents, emb
-00000260: 6564 5f6d 6f64 656c 203d 2065 6d62 6564  ed_model = embed
-00000270: 5f6d 6f64 656c 2c20 7368 6f77 5f70 726f  _model, show_pro
-00000280: 6772 6573 733d 5472 7565 290d 0a20 2020  gress=True)..   
-00000290: 2071 7565 7279 5f65 6e67 696e 6520 3d20   query_engine = 
-000002a0: 696e 6465 782e 6173 5f71 7565 7279 5f65  index.as_query_e
-000002b0: 6e67 696e 6528 7369 6d69 6c61 7269 7479  ngine(similarity
-000002c0: 5f74 6f70 5f6b 3d33 2c6c 6c6d 3d6c 6c6d  _top_k=3,llm=llm
-000002d0: 290d 0a20 2020 2077 6869 6c65 2054 7275  )..    while Tru
-000002e0: 653a 0d0a 2020 2020 2020 2020 7175 6572  e:..        quer
-000002f0: 7920 3d20 696e 7075 7428 2251 7565 7279  y = input("Query
-00000300: 3a22 290d 0a20 2020 2020 2020 2072 6573  :")..        res
-00000310: 706f 6e73 6520 3d20 7175 6572 795f 656e  ponse = query_en
-00000320: 6769 6e65 2e71 7565 7279 2871 7565 7279  gine.query(query
-00000330: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
-00000340: 2873 7472 2872 6573 706f 6e73 6529 290d  (str(response)).
-00000350: 0a0d 0a0d 0a64 6566 2065 6d62 6564 5f61  .....def embed_a
-00000360: 6e64 5f72 756e 5f6f 7065 6e61 6928 646f  nd_run_openai(do
-00000370: 6375 6d65 6e74 7329 3a0d 0a20 2020 2069  cuments):..    i
-00000380: 6d70 6f72 7420 6f73 0d0a 2020 2020 696d  mport os..    im
-00000390: 706f 7274 206f 7065 6e61 690d 0a20 2020  port openai..   
-000003a0: 2066 726f 6d20 6c6c 616d 615f 696e 6465   from llama_inde
-000003b0: 782e 6c6c 6d73 2e6f 7065 6e61 6920 696d  x.llms.openai im
-000003c0: 706f 7274 204f 7065 6e41 490d 0a20 2020  port OpenAI..   
-000003d0: 2066 726f 6d20 6c6c 616d 615f 696e 6465   from llama_inde
-000003e0: 782e 636f 7265 2069 6d70 6f72 7420 5665  x.core import Ve
-000003f0: 6374 6f72 5374 6f72 6549 6e64 6578 0d0a  ctorStoreIndex..
-00000400: 2020 2020 6f73 2e65 6e76 6972 6f6e 5b22      os.environ["
-00000410: 4f50 454e 4149 5f41 5049 5f4b 4559 225d  OPENAI_API_KEY"]
-00000420: 203d 2022 736b 2d50 6c36 6e4c 465a 5168   = "sk-Pl6nLFZQh
-00000430: 4d74 4f4b 6b59 3335 4c68 7254 3342 6c62  MtOKkY35LhrT3Blb
-00000440: 6b46 4a72 394a 6644 335a 7049 4774 706b  kFJr9JfD3ZpIGtpk
-00000450: 4638 664a 5663 6222 0d0a 2020 2020 6f70  F8fJVcb"..    op
-00000460: 656e 6169 2e61 7069 5f6b 6579 203d 206f  enai.api_key = o
-00000470: 732e 656e 7669 726f 6e5b 224f 5045 4e41  s.environ["OPENA
-00000480: 495f 4150 495f 4b45 5922 5d0d 0a20 2020  I_API_KEY"]..   
-00000490: 2069 6e64 6578 203d 2056 6563 746f 7253   index = VectorS
-000004a0: 746f 7265 496e 6465 782e 6672 6f6d 5f64  toreIndex.from_d
-000004b0: 6f63 756d 656e 7473 2864 6f63 756d 656e  ocuments(documen
-000004c0: 7473 2c20 7368 6f77 5f70 726f 6772 6573  ts, show_progres
-000004d0: 733d 5472 7565 2923 2c20 656d 6265 645f  s=True)#, embed_
-000004e0: 6d6f 6465 6c20 3d20 656d 6265 645f 6d6f  model = embed_mo
-000004f0: 6465 6c2c 2073 686f 775f 7072 6f67 7265  del, show_progre
-00000500: 7373 3d54 7275 652c 290d 0a20 2020 206c  ss=True,)..    l
-00000510: 6c6d 203d 204f 7065 6e41 4928 6d6f 6465  lm = OpenAI(mode
-00000520: 6c3d 2267 7074 2d33 2e35 2d74 7572 626f  l="gpt-3.5-turbo
-00000530: 2229 0d0a 2020 2020 7175 6572 795f 656e  ")..    query_en
-00000540: 6769 6e65 203d 2069 6e64 6578 2e61 735f  gine = index.as_
-00000550: 7175 6572 795f 656e 6769 6e65 2873 696d  query_engine(sim
-00000560: 696c 6172 6974 795f 746f 705f 6b3d 332c  ilarity_top_k=3,
-00000570: 6c6c 6d3d 6c6c 6d29 0d0a 2020 2020 7768  llm=llm)..    wh
-00000580: 696c 6520 5472 7565 3a0d 0a20 2020 2020  ile True:..     
-00000590: 2020 2071 7565 7279 203d 2069 6e70 7574     query = input
-000005a0: 2822 5175 6572 793a 2229 0d0a 2020 2020  ("Query:")..    
-000005b0: 2020 2020 7265 7370 6f6e 7365 203d 2071      response = q
-000005c0: 7565 7279 5f65 6e67 696e 652e 7175 6572  uery_engine.quer
-000005d0: 7928 7175 6572 7929 0d0a 2020 2020 2020  y(query)..      
-000005e0: 2020 7072 696e 7428 7374 7228 7265 7370    print(str(resp
-000005f0: 6f6e 7365 2929 0d0a 2020 2020 0d0a 0d0a  onse))..    ....
-00000600: 6465 6620 656d 6265 645f 616e 645f 7275  def embed_and_ru
-00000610: 6e5f 617a 7572 656f 7065 6e61 6928 646f  n_azureopenai(do
-00000620: 6375 6d65 6e74 7329 3a0d 0a20 2020 200d  cuments):..    .
-00000630: 0a20 2020 2066 726f 6d20 6c6c 616d 615f  .    from llama_
-00000640: 696e 6465 782e 6c6c 6d73 2e61 7a75 7265  index.llms.azure
-00000650: 5f6f 7065 6e61 6920 696d 706f 7274 2041  _openai import A
-00000660: 7a75 7265 4f70 656e 4149 0d0a 2020 2020  zureOpenAI..    
-00000670: 6672 6f6d 206c 6c61 6d61 5f69 6e64 6578  from llama_index
-00000680: 2e65 6d62 6564 6469 6e67 732e 617a 7572  .embeddings.azur
-00000690: 655f 6f70 656e 6169 2069 6d70 6f72 7420  e_openai import 
-000006a0: 417a 7572 654f 7065 6e41 4945 6d62 6564  AzureOpenAIEmbed
-000006b0: 6469 6e67 0d0a 2020 2020 6672 6f6d 206c  ding..    from l
-000006c0: 6c61 6d61 5f69 6e64 6578 2e63 6f72 6520  lama_index.core 
-000006d0: 696d 706f 7274 2056 6563 746f 7253 746f  import VectorSto
-000006e0: 7265 496e 6465 780d 0a0d 0a0d 0a20 2020  reIndex......   
-000006f0: 2061 7069 5f6b 6579 3d20 2231 3762 3135   api_key= "17b15
-00000700: 6339 6330 6333 3634 3333 3638 6262 3865  c9c0c3643368bb8e
-00000710: 3965 3263 3561 6461 3036 6622 200d 0a20  9e2c5ada06f" .. 
-00000720: 2020 2061 7069 5f76 6572 7369 6f6e 3d22     api_version="
-00000730: 3230 3233 2d30 372d 3031 2d70 7265 7669  2023-07-01-previ
-00000740: 6577 220d 0a20 2020 2061 7a75 7265 5f65  ew"..    azure_e
-00000750: 6e64 706f 696e 743d 2268 7474 7073 3a2f  ndpoint="https:/
-00000760: 2f63 6f76 616c 656e 7365 6f70 656e 6169  /covalenseopenai
-00000770: 6561 7374 7573 322e 6f70 656e 6169 2e61  eastus2.openai.a
-00000780: 7a75 7265 2e63 6f6d 2f22 0d0a 0d0a 2020  zure.com/"....  
-00000790: 2020 6c6c 6d20 3d20 417a 7572 654f 7065    llm = AzureOpe
-000007a0: 6e41 4928 0d0a 2020 2020 2020 2020 6d6f  nAI(..        mo
-000007b0: 6465 6c3d 2267 7074 2d33 352d 7475 7262  del="gpt-35-turb
-000007c0: 6f2d 3136 6b22 2c0d 0a20 2020 2020 2020  o-16k",..       
-000007d0: 2064 6570 6c6f 796d 656e 745f 6e61 6d65   deployment_name
-000007e0: 3d22 6770 742d 3335 2d74 7572 626f 2d31  ="gpt-35-turbo-1
-000007f0: 366b 222c 0d0a 2020 2020 2020 2020 6170  6k",..        ap
-00000800: 695f 6b65 793d 6170 695f 6b65 792c 0d0a  i_key=api_key,..
-00000810: 2020 2020 2020 2020 617a 7572 655f 656e          azure_en
-00000820: 6470 6f69 6e74 3d61 7a75 7265 5f65 6e64  dpoint=azure_end
-00000830: 706f 696e 742c 0d0a 2020 2020 2020 2020  point,..        
-00000840: 6170 695f 7665 7273 696f 6e3d 6170 695f  api_version=api_
-00000850: 7665 7273 696f 6e2c 0d0a 2020 2020 290d  version,..    ).
-00000860: 0a0d 0a20 2020 2023 2059 6f75 206e 6565  ...    # You nee
-00000870: 6420 746f 2064 6570 6c6f 7920 796f 7572  d to deploy your
-00000880: 206f 776e 2065 6d62 6564 6469 6e67 206d   own embedding m
-00000890: 6f64 656c 2061 7320 7765 6c6c 2061 7320  odel as well as 
-000008a0: 796f 7572 206f 776e 2063 6861 7420 636f  your own chat co
-000008b0: 6d70 6c65 7469 6f6e 206d 6f64 656c 0d0a  mpletion model..
-000008c0: 2020 2020 656d 6265 645f 6d6f 6465 6c20      embed_model 
-000008d0: 3d20 417a 7572 654f 7065 6e41 4945 6d62  = AzureOpenAIEmb
-000008e0: 6564 6469 6e67 280d 0a20 2020 2020 2020  edding(..       
-000008f0: 206d 6f64 656c 3d22 7465 7874 2d65 6d62   model="text-emb
-00000900: 6564 6469 6e67 2d61 6461 2d30 3032 222c  edding-ada-002",
-00000910: 0d0a 2020 2020 2020 2020 6465 706c 6f79  ..        deploy
-00000920: 6d65 6e74 5f6e 616d 653d 2274 6578 742d  ment_name="text-
-00000930: 656d 6265 6464 696e 672d 6164 612d 3030  embedding-ada-00
-00000940: 3222 2c0d 0a20 2020 2020 2020 2061 7069  2",..        api
-00000950: 5f6b 6579 3d61 7069 5f6b 6579 2c0d 0a20  _key=api_key,.. 
-00000960: 2020 2020 2020 2061 7a75 7265 5f65 6e64         azure_end
-00000970: 706f 696e 743d 617a 7572 655f 656e 6470  point=azure_endp
-00000980: 6f69 6e74 2c0d 0a20 2020 2020 2020 2061  oint,..        a
-00000990: 7069 5f76 6572 7369 6f6e 3d61 7069 5f76  pi_version=api_v
-000009a0: 6572 7369 6f6e 2c0d 0a20 2020 2029 0d0a  ersion,..    )..
-000009b0: 0d0a 2020 2020 6672 6f6d 206c 6c61 6d61  ..    from llama
-000009c0: 5f69 6e64 6578 2e63 6f72 6520 696d 706f  _index.core impo
-000009d0: 7274 2053 6574 7469 6e67 730d 0a20 2020  rt Settings..   
-000009e0: 2053 6574 7469 6e67 732e 6c6c 6d20 3d20   Settings.llm = 
-000009f0: 6c6c 6d0d 0a20 2020 2053 6574 7469 6e67  llm..    Setting
-00000a00: 732e 656d 6265 645f 6d6f 6465 6c20 3d20  s.embed_model = 
-00000a10: 656d 6265 645f 6d6f 6465 6c0d 0a0d 0a20  embed_model.... 
-00000a20: 2020 2069 6e64 6578 203d 2056 6563 746f     index = Vecto
-00000a30: 7253 746f 7265 496e 6465 782e 6672 6f6d  rStoreIndex.from
-00000a40: 5f64 6f63 756d 656e 7473 2864 6f63 756d  _documents(docum
-00000a50: 656e 7473 2c20 7368 6f77 5f70 726f 6772  ents, show_progr
-00000a60: 6573 733d 5472 7565 2923 2c20 656d 6265  ess=True)#, embe
-00000a70: 645f 6d6f 6465 6c20 3d20 656d 6265 645f  d_model = embed_
-00000a80: 6d6f 6465 6c2c 2073 686f 775f 7072 6f67  model, show_prog
-00000a90: 7265 7373 3d54 7275 652c 290d 0a20 2020  ress=True,)..   
-00000aa0: 2071 7565 7279 5f65 6e67 696e 6520 3d20   query_engine = 
-00000ab0: 696e 6465 782e 6173 5f71 7565 7279 5f65  index.as_query_e
-00000ac0: 6e67 696e 6528 7369 6d69 6c61 7269 7479  ngine(similarity
-00000ad0: 5f74 6f70 5f6b 3d33 2c6c 6c6d 3d6c 6c6d  _top_k=3,llm=llm
-00000ae0: 290d 0a20 2020 2077 6869 6c65 2054 7275  )..    while Tru
-00000af0: 653a 0d0a 2020 2020 2020 2020 7175 6572  e:..        quer
-00000b00: 7920 3d20 696e 7075 7428 2251 7565 7279  y = input("Query
-00000b10: 3a22 290d 0a20 2020 2020 2020 2072 6573  :")..        res
-00000b20: 706f 6e73 6520 3d20 7175 6572 795f 656e  ponse = query_en
-00000b30: 6769 6e65 2e71 7565 7279 2871 7565 7279  gine.query(query
-00000b40: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
-00000b50: 2873 7472 2872 6573 706f 6e73 6529 290d  (str(response)).
-00000b60: 0a0d 0a64 6566 2063 7376 5f65 6e67 696e  ...def csv_engin
-00000b70: 6528 6466 293a 0d0a 2020 2020 6672 6f6d  e(df):..    from
-00000b80: 206c 6c61 6d61 5f69 6e64 6578 2e63 6f72   llama_index.cor
-00000b90: 652e 7175 6572 795f 7069 7065 6c69 6e65  e.query_pipeline
-00000ba0: 2069 6d70 6f72 7420 280d 0a20 2020 2051   import (..    Q
-00000bb0: 7565 7279 5069 7065 6c69 6e65 2061 7320  ueryPipeline as 
-00000bc0: 5150 2c0d 0a20 2020 204c 696e 6b2c 0d0a  QP,..    Link,..
-00000bd0: 2020 2020 496e 7075 7443 6f6d 706f 6e65      InputCompone
-00000be0: 6e74 2c0d 0a20 2020 2029 0d0a 2020 2020  nt,..    )..    
-00000bf0: 6672 6f6d 206c 6c61 6d61 5f69 6e64 6578  from llama_index
-00000c00: 2e63 6f72 652e 7175 6572 795f 656e 6769  .core.query_engi
-00000c10: 6e65 2e70 616e 6461 7320 696d 706f 7274  ne.pandas import
-00000c20: 2050 616e 6461 7349 6e73 7472 7563 7469   PandasInstructi
-00000c30: 6f6e 5061 7273 6572 0d0a 2020 2020 6672  onParser..    fr
-00000c40: 6f6d 206c 6c61 6d61 5f69 6e64 6578 2e63  om llama_index.c
-00000c50: 6f72 6520 696d 706f 7274 2050 726f 6d70  ore import Promp
-00000c60: 7454 656d 706c 6174 650d 0a20 2020 2066  tTemplate..    f
-00000c70: 726f 6d20 6c6c 616d 615f 696e 6465 782e  rom llama_index.
-00000c80: 6c6c 6d73 2e61 7a75 7265 5f6f 7065 6e61  llms.azure_opena
-00000c90: 6920 696d 706f 7274 2041 7a75 7265 4f70  i import AzureOp
-00000ca0: 656e 4149 0d0a 0d0a 2020 2020 6170 695f  enAI....    api_
-00000cb0: 6b65 793d 2022 3137 6231 3563 3963 3063  key= "17b15c9c0c
-00000cc0: 3336 3433 3336 3862 6238 6539 6532 6335  3643368bb8e9e2c5
-00000cd0: 6164 6130 3666 2220 0d0a 2020 2020 6170  ada06f" ..    ap
-00000ce0: 695f 7665 7273 696f 6e3d 2232 3032 332d  i_version="2023-
-00000cf0: 3037 2d30 312d 7072 6576 6965 7722 0d0a  07-01-preview"..
-00000d00: 2020 2020 617a 7572 655f 656e 6470 6f69      azure_endpoi
-00000d10: 6e74 3d22 6874 7470 733a 2f2f 636f 7661  nt="https://cova
-00000d20: 6c65 6e73 656f 7065 6e61 6965 6173 7475  lenseopenaieastu
-00000d30: 7332 2e6f 7065 6e61 692e 617a 7572 652e  s2.openai.azure.
-00000d40: 636f 6d2f 220d 0a0d 0a20 2020 206c 6c6d  com/"....    llm
-00000d50: 203d 2041 7a75 7265 4f70 656e 4149 280d   = AzureOpenAI(.
-00000d60: 0a20 2020 2020 2020 206d 6f64 656c 3d22  .        model="
-00000d70: 6770 742d 3335 2d74 7572 626f 2d31 366b  gpt-35-turbo-16k
-00000d80: 222c 0d0a 2020 2020 2020 2020 6465 706c  ",..        depl
-00000d90: 6f79 6d65 6e74 5f6e 616d 653d 2267 7074  oyment_name="gpt
-00000da0: 2d33 352d 7475 7262 6f2d 3136 6b22 2c0d  -35-turbo-16k",.
-00000db0: 0a20 2020 2020 2020 2061 7069 5f6b 6579  .        api_key
-00000dc0: 3d61 7069 5f6b 6579 2c0d 0a20 2020 2020  =api_key,..     
-00000dd0: 2020 2061 7a75 7265 5f65 6e64 706f 696e     azure_endpoin
-00000de0: 743d 617a 7572 655f 656e 6470 6f69 6e74  t=azure_endpoint
-00000df0: 2c0d 0a20 2020 2020 2020 2061 7069 5f76  ,..        api_v
-00000e00: 6572 7369 6f6e 3d61 7069 5f76 6572 7369  ersion=api_versi
-00000e10: 6f6e 2c0d 0a20 2020 2029 0d0a 0d0a 2020  on,..    )....  
-00000e20: 2020 696e 7374 7275 6374 696f 6e5f 7374    instruction_st
-00000e30: 7220 3d20 280d 0a20 2020 2022 312e 2043  r = (..    "1. C
-00000e40: 6f6e 7665 7274 2074 6865 2071 7565 7279  onvert the query
-00000e50: 2074 6f20 6578 6563 7574 6162 6c65 2050   to executable P
-00000e60: 7974 686f 6e20 636f 6465 2075 7369 6e67  ython code using
-00000e70: 2050 616e 6461 732e 5c6e 220d 0a20 2020   Pandas.\n"..   
-00000e80: 2022 322e 2054 6865 2066 696e 616c 206c   "2. The final l
-00000e90: 696e 6520 6f66 2063 6f64 6520 7368 6f75  ine of code shou
-00000ea0: 6c64 2062 6520 6120 5079 7468 6f6e 2065  ld be a Python e
-00000eb0: 7870 7265 7373 696f 6e20 7468 6174 2063  xpression that c
-00000ec0: 616e 2062 6520 6361 6c6c 6564 2077 6974  an be called wit
-00000ed0: 6820 7468 6520 6065 7661 6c28 2960 2066  h the `eval()` f
-00000ee0: 756e 6374 696f 6e2e 5c6e 220d 0a20 2020  unction.\n"..   
-00000ef0: 2022 332e 2054 6865 2063 6f64 6520 7368   "3. The code sh
-00000f00: 6f75 6c64 2072 6570 7265 7365 6e74 2061  ould represent a
-00000f10: 2073 6f6c 7574 696f 6e20 746f 2074 6865   solution to the
-00000f20: 2071 7565 7279 2e5c 6e22 0d0a 2020 2020   query.\n"..    
-00000f30: 2234 2e20 5052 494e 5420 4f4e 4c59 2054  "4. PRINT ONLY T
-00000f40: 4845 2045 5850 5245 5353 494f 4e2e 5c6e  HE EXPRESSION.\n
-00000f50: 220d 0a20 2020 2022 352e 2044 6f20 6e6f  "..    "5. Do no
-00000f60: 7420 7175 6f74 6520 7468 6520 6578 7072  t quote the expr
-00000f70: 6573 7369 6f6e 2e5c 6e22 0d0a 2020 2020  ession.\n"..    
-00000f80: 6622 362e 2053 7472 6963 746c 7920 7573  f"6. Strictly us
-00000f90: 6520 636f 6c75 6d6e 206e 616d 6573 206d  e column names m
-00000fa0: 656e 7469 6f6e 6564 2062 656c 6f77 207b  entioned below {
-00000fb0: 6466 2e68 6561 6428 3129 7d22 290d 0a0d  df.head(1)}")...
-00000fc0: 0a20 2020 2070 616e 6461 735f 7072 6f6d  .    pandas_prom
-00000fd0: 7074 5f73 7472 203d 2028 0d0a 2020 2020  pt_str = (..    
-00000fe0: 2020 2020 2259 6f75 2061 7265 2077 6f72      "You are wor
-00000ff0: 6b69 6e67 2077 6974 6820 6120 7061 6e64  king with a pand
-00001000: 6173 2064 6174 6166 7261 6d65 2069 6e20  as dataframe in 
-00001010: 5079 7468 6f6e 2e5c 6e22 0d0a 2020 2020  Python.\n"..    
-00001020: 2020 2020 2254 6865 206e 616d 6520 6f66      "The name of
-00001030: 2074 6865 2064 6174 6166 7261 6d65 2069   the dataframe i
-00001040: 7320 6064 6660 2e5c 6e22 0d0a 2020 2020  s `df`.\n"..    
-00001050: 2020 2020 2254 6869 7320 6973 2074 6865      "This is the
-00001060: 2072 6573 756c 7420 6f66 2060 7072 696e   result of `prin
-00001070: 7428 6466 2e68 6561 6428 2929 603a 5c6e  t(df.head())`:\n
-00001080: 220d 0a20 2020 2020 2020 2022 7b64 665f  "..        "{df_
-00001090: 7374 727d 5c6e 5c6e 220d 0a20 2020 2020  str}\n\n"..     
-000010a0: 2020 2022 466f 6c6c 6f77 2074 6865 7365     "Follow these
-000010b0: 2069 6e73 7472 7563 7469 6f6e 733a 5c6e   instructions:\n
-000010c0: 220d 0a20 2020 2020 2020 2022 7b69 6e73  "..        "{ins
-000010d0: 7472 7563 7469 6f6e 5f73 7472 7d5c 6e22  truction_str}\n"
-000010e0: 0d0a 2020 2020 2020 2020 2251 7565 7279  ..        "Query
-000010f0: 3a20 7b71 7565 7279 5f73 7472 7d5c 6e5c  : {query_str}\n\
-00001100: 6e22 0d0a 2020 2020 2020 2020 2245 7870  n"..        "Exp
-00001110: 7265 7373 696f 6e3a 2229 0d0a 2020 2020  ression:")..    
-00001120: 0d0a 2020 2020 7265 7370 6f6e 7365 5f73  ..    response_s
-00001130: 796e 7468 6573 6973 5f70 726f 6d70 745f  ynthesis_prompt_
-00001140: 7374 7220 3d20 280d 0a20 2020 2020 2020  str = (..       
-00001150: 2022 4769 7665 6e20 616e 2069 6e70 7574   "Given an input
-00001160: 2071 7565 7374 696f 6e2c 2073 796e 7468   question, synth
-00001170: 6573 697a 6520 6120 7265 7370 6f6e 7365  esize a response
-00001180: 2066 726f 6d20 7468 6520 7175 6572 7920   from the query 
-00001190: 7265 7375 6c74 732e 5c6e 220d 0a20 2020  results.\n"..   
-000011a0: 2020 2020 2022 5175 6572 793a 207b 7175       "Query: {qu
-000011b0: 6572 795f 7374 727d 5c6e 5c6e 220d 0a20  ery_str}\n\n".. 
-000011c0: 2020 2020 2020 2022 5061 6e64 6173 2049         "Pandas I
-000011d0: 6e73 7472 7563 7469 6f6e 7320 286f 7074  nstructions (opt
-000011e0: 696f 6e61 6c29 3a5c 6e7b 7061 6e64 6173  ional):\n{pandas
-000011f0: 5f69 6e73 7472 7563 7469 6f6e 737d 5c6e  _instructions}\n
-00001200: 5c6e 220d 0a20 2020 2020 2020 2022 5061  \n"..        "Pa
-00001210: 6e64 6173 204f 7574 7075 743a 207b 7061  ndas Output: {pa
-00001220: 6e64 6173 5f6f 7574 7075 747d 5c6e 5c6e  ndas_output}\n\n
-00001230: 220d 0a20 2020 2020 2020 2022 5265 7370  "..        "Resp
-00001240: 6f6e 7365 3a20 2229 0d0a 0d0a 2020 2020  onse: ")....    
-00001250: 7061 6e64 6173 5f70 726f 6d70 7420 3d20  pandas_prompt = 
-00001260: 5072 6f6d 7074 5465 6d70 6c61 7465 2870  PromptTemplate(p
-00001270: 616e 6461 735f 7072 6f6d 7074 5f73 7472  andas_prompt_str
-00001280: 292e 7061 7274 6961 6c5f 666f 726d 6174  ).partial_format
-00001290: 280d 0a20 2020 2020 2020 2069 6e73 7472  (..        instr
-000012a0: 7563 7469 6f6e 5f73 7472 3d69 6e73 7472  uction_str=instr
-000012b0: 7563 7469 6f6e 5f73 7472 2c20 6466 5f73  uction_str, df_s
-000012c0: 7472 3d64 662e 6865 6164 2835 2929 0d0a  tr=df.head(5))..
-000012d0: 2020 2020 0d0a 2020 2020 7061 6e64 6173      ..    pandas
-000012e0: 5f6f 7574 7075 745f 7061 7273 6572 203d  _output_parser =
-000012f0: 2050 616e 6461 7349 6e73 7472 7563 7469   PandasInstructi
-00001300: 6f6e 5061 7273 6572 2864 6629 0d0a 2020  onParser(df)..  
-00001310: 2020 7265 7370 6f6e 7365 5f73 796e 7468    response_synth
-00001320: 6573 6973 5f70 726f 6d70 7420 3d20 5072  esis_prompt = Pr
-00001330: 6f6d 7074 5465 6d70 6c61 7465 2872 6573  omptTemplate(res
-00001340: 706f 6e73 655f 7379 6e74 6865 7369 735f  ponse_synthesis_
-00001350: 7072 6f6d 7074 5f73 7472 290d 0a20 2020  prompt_str)..   
-00001360: 2023 206c 6c6d 203d 204f 7065 6e41 4928   # llm = OpenAI(
-00001370: 6d6f 6465 6c3d 2267 7074 2d33 2e35 2d74  model="gpt-3.5-t
-00001380: 7572 626f 2229 0d0a 0d0a 2020 2020 7170  urbo")....    qp
-00001390: 203d 2051 5028 0d0a 2020 2020 6d6f 6475   = QP(..    modu
-000013a0: 6c65 733d 7b0d 0a20 2020 2020 2020 2022  les={..        "
-000013b0: 696e 7075 7422 3a20 496e 7075 7443 6f6d  input": InputCom
-000013c0: 706f 6e65 6e74 2829 2c0d 0a20 2020 2020  ponent(),..     
-000013d0: 2020 2022 7061 6e64 6173 5f70 726f 6d70     "pandas_promp
-000013e0: 7422 3a20 7061 6e64 6173 5f70 726f 6d70  t": pandas_promp
-000013f0: 742c 0d0a 2020 2020 2020 2020 226c 6c6d  t,..        "llm
-00001400: 3122 3a20 6c6c 6d2c 0d0a 2020 2020 2020  1": llm,..      
-00001410: 2020 2270 616e 6461 735f 6f75 7470 7574    "pandas_output
-00001420: 5f70 6172 7365 7222 3a20 7061 6e64 6173  _parser": pandas
-00001430: 5f6f 7574 7075 745f 7061 7273 6572 2c0d  _output_parser,.
-00001440: 0a20 2020 2020 2020 2022 7265 7370 6f6e  .        "respon
-00001450: 7365 5f73 796e 7468 6573 6973 5f70 726f  se_synthesis_pro
-00001460: 6d70 7422 3a20 7265 7370 6f6e 7365 5f73  mpt": response_s
-00001470: 796e 7468 6573 6973 5f70 726f 6d70 742c  ynthesis_prompt,
-00001480: 0d0a 2020 2020 2020 2020 226c 6c6d 3222  ..        "llm2"
-00001490: 3a20 6c6c 6d2c 0d0a 2020 2020 7d2c 0d0a  : llm,..    },..
-000014a0: 2020 2020 7665 7262 6f73 653d 5472 7565      verbose=True
-000014b0: 2c0d 0a20 2020 2029 0d0a 2020 2020 7170  ,..    )..    qp
-000014c0: 2e61 6464 5f63 6861 696e 285b 2269 6e70  .add_chain(["inp
-000014d0: 7574 222c 2022 7061 6e64 6173 5f70 726f  ut", "pandas_pro
-000014e0: 6d70 7422 2c20 226c 6c6d 3122 2c20 2270  mpt", "llm1", "p
-000014f0: 616e 6461 735f 6f75 7470 7574 5f70 6172  andas_output_par
-00001500: 7365 7222 5d29 0d0a 2020 2020 7170 2e61  ser"])..    qp.a
-00001510: 6464 5f6c 696e 6b73 280d 0a20 2020 2020  dd_links(..     
-00001520: 2020 205b 0d0a 2020 2020 2020 2020 2020     [..          
-00001530: 2020 4c69 6e6b 2822 696e 7075 7422 2c20    Link("input", 
-00001540: 2272 6573 706f 6e73 655f 7379 6e74 6865  "response_synthe
-00001550: 7369 735f 7072 6f6d 7074 222c 2064 6573  sis_prompt", des
-00001560: 745f 6b65 793d 2271 7565 7279 5f73 7472  t_key="query_str
-00001570: 2229 2c0d 0a20 2020 2020 2020 2020 2020  "),..           
-00001580: 204c 696e 6b28 0d0a 2020 2020 2020 2020   Link(..        
-00001590: 2020 2020 2020 2020 226c 6c6d 3122 2c20          "llm1", 
-000015a0: 2272 6573 706f 6e73 655f 7379 6e74 6865  "response_synthe
-000015b0: 7369 735f 7072 6f6d 7074 222c 2064 6573  sis_prompt", des
-000015c0: 745f 6b65 793d 2270 616e 6461 735f 696e  t_key="pandas_in
-000015d0: 7374 7275 6374 696f 6e73 220d 0a20 2020  structions"..   
-000015e0: 2020 2020 2020 2020 2029 2c0d 0a20 2020           ),..   
-000015f0: 2020 2020 2020 2020 204c 696e 6b28 0d0a           Link(..
-00001600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001610: 2270 616e 6461 735f 6f75 7470 7574 5f70  "pandas_output_p
-00001620: 6172 7365 7222 2c0d 0a20 2020 2020 2020  arser",..       
-00001630: 2020 2020 2020 2020 2022 7265 7370 6f6e           "respon
-00001640: 7365 5f73 796e 7468 6573 6973 5f70 726f  se_synthesis_pro
-00001650: 6d70 7422 2c0d 0a20 2020 2020 2020 2020  mpt",..         
-00001660: 2020 2020 2020 2064 6573 745f 6b65 793d         dest_key=
-00001670: 2270 616e 6461 735f 6f75 7470 7574 222c  "pandas_output",
-00001680: 0d0a 2020 2020 2020 2020 2020 2020 292c  ..            ),
-00001690: 0d0a 2020 2020 2020 2020 5d0d 0a20 2020  ..        ]..   
-000016a0: 2029 0d0a 2020 2020 2320 6164 6420 6c69   )..    # add li
-000016b0: 6e6b 2066 726f 6d20 7265 7370 6f6e 7365  nk from response
-000016c0: 2073 796e 7468 6573 6973 2070 726f 6d70   synthesis promp
-000016d0: 7420 746f 206c 6c6d 320d 0a20 2020 2071  t to llm2..    q
-000016e0: 702e 6164 645f 6c69 6e6b 2822 7265 7370  p.add_link("resp
-000016f0: 6f6e 7365 5f73 796e 7468 6573 6973 5f70  onse_synthesis_p
-00001700: 726f 6d70 7422 2c20 226c 6c6d 3222 290d  rompt", "llm2").
-00001710: 0a0d 0a20 2020 2077 6869 6c65 2054 7275  ...    while Tru
-00001720: 653a 0d0a 2020 2020 2020 2020 7175 6572  e:..        quer
-00001730: 795f 7374 7220 3d20 696e 7075 7428 2251  y_str = input("Q
-00001740: 7565 7279 3a22 290d 0a20 2020 2020 2020  uery:")..       
-00001750: 2072 6573 706f 6e73 6520 3d20 7170 2e72   response = qp.r
-00001760: 756e 2871 7565 7279 5f73 7472 3d71 7565  un(query_str=que
-00001770: 7279 5f73 7472 2c29 0d0a 2020 2020 2020  ry_str,)..      
-00001780: 2020 7072 696e 7428 7265 7370 6f6e 7365    print(response
-00001790: 2e6d 6573 7361 6765 2e63 6f6e 7465 6e74  .message.content
-000017a0: 290d 0a0d 0a64 6566 2065 6d62 6564 5f61  )....def embed_a
-000017b0: 6e64 5f72 756e 2865 6d62 6564 6469 6e67  nd_run(embedding
-000017c0: 7329 3a0d 0a20 2020 2077 6869 6c65 2054  s):..    while T
-000017d0: 7275 653a 0d0a 2020 2020 2020 2020 6368  rue:..        ch
-000017e0: 6f69 6365 203d 2069 6e70 7574 2822 506c  oice = input("Pl
-000017f0: 6561 7365 2063 686f 6f73 6520 7468 6520  ease choose the 
-00001800: 7072 6566 6572 6564 2065 6e67 696e 653a  prefered engine:
-00001810: 205c 6e31 2e20 417a 7572 6520 4f70 656e   \n1. Azure Open
-00001820: 6169 205c 6e32 2e4d 6973 7472 616c 2d41  ai \n2.Mistral-A
-00001830: 6920 5c6e 332e 4353 5620 656e 6769 6e65  i \n3.CSV engine
-00001840: 5c6e 2059 6f75 7220 4368 6f69 6365 2028  \n Your Choice (
-00001850: 312f 322f 3329 3a20 2229 0d0a 2020 2020  1/2/3): ")..    
-00001860: 2020 2020 6966 2063 686f 6963 6520 3d3d      if choice ==
-00001870: 2027 3127 3a0d 0a20 2020 2020 2020 2020   '1':..         
-00001880: 2020 2065 6d62 6564 5f61 6e64 5f72 756e     embed_and_run
-00001890: 5f61 7a75 7265 6f70 656e 6169 2865 6d62  _azureopenai(emb
-000018a0: 6564 6469 6e67 7329 0d0a 2020 2020 2020  eddings)..      
-000018b0: 2020 656c 6966 2063 686f 6963 6520 3d3d    elif choice ==
-000018c0: 2027 3227 3a0d 0a20 2020 2020 2020 2020   '2':..         
-000018d0: 2020 2065 6d62 6564 5f61 6e64 5f72 756e     embed_and_run
-000018e0: 5f6d 6973 7472 616c 2865 6d62 6564 6469  _mistral(embeddi
-000018f0: 6e67 7329 0d0a 2020 2020 2020 2020 656c  ngs)..        el
-00001900: 6966 2063 686f 6963 6520 3d3d 2027 3327  if choice == '3'
-00001910: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
-00001920: 7376 5f65 6e67 696e 6528 656d 6265 6464  sv_engine(embedd
-00001930: 696e 6773 290d 0a20 2020 2020 2020 2065  ings)..        e
-00001940: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00001950: 2020 7072 696e 7428 2270 6c65 6173 6520    print("please 
-00001960: 6368 6f6f 7365 206f 6e65 206f 6620 7468  choose one of th
-00001970: 6520 6f70 7469 6f6e 7320 6d65 6e74 696f  e options mentio
-00001980: 6e65 6422 290d 0a0d 0a0d 0a0d 0a23 2066  ned")........# f
-00001990: 726f 6d20 6c61 6e67 6368 6169 6e5f 676f  rom langchain_go
-000019a0: 6f67 6c65 5f67 656e 6169 2069 6d70 6f72  ogle_genai impor
-000019b0: 7420 476f 6f67 6c65 4765 6e65 7261 7469  t GoogleGenerati
-000019c0: 7665 4149 456d 6265 6464 696e 6773 0d0a  veAIEmbeddings..
-000019d0: 2320 696d 706f 7274 206f 730d 0a23 2069  # import os..# i
-000019e0: 6d70 6f72 7420 676f 6f67 6c65 2e67 656e  mport google.gen
-000019f0: 6572 6174 6976 6561 6920 6173 2067 656e  erativeai as gen
-00001a00: 6169 0d0a 0d0a 2320 6f73 2e65 6e76 6972  ai....# os.envir
-00001a10: 6f6e 5b27 474f 4f47 4c45 5f41 5049 5f4b  on['GOOGLE_API_K
-00001a20: 4559 275d 203d 2022 4149 7a61 5379 4148  EY'] = "AIzaSyAH
-00001a30: 614c 3442 486f 5f37 376c 3137 6f44 634e  aL4BHo_77l17oDcN
-00001a40: 6a76 6c47 4a45 495a 676a 736a 5379 4522  jvlGJEIZgjsjSyE"
-00001a50: 2020 2320 5265 706c 6163 6520 7769 7468    # Replace with
-00001a60: 2079 6f75 7220 4150 4920 6b65 790d 0a23   your API key..#
-00001a70: 2067 656e 6169 2e63 6f6e 6669 6775 7265   genai.configure
-00001a80: 2861 7069 5f6b 6579 3d6f 732e 656e 7669  (api_key=os.envi
-00001a90: 726f 6e5b 2747 4f4f 474c 455f 4150 495f  ron['GOOGLE_API_
-00001aa0: 4b45 5927 5d29 0d0a 0d0a 0d0a 0d0a 2320  KEY'])........# 
-00001ab0: 656d 6265 645f 6d6f 6465 6c20 3d20 476f  embed_model = Go
-00001ac0: 6f67 6c65 4765 6e65 7261 7469 7665 4149  ogleGenerativeAI
-00001ad0: 456d 6265 6464 696e 6773 286d 6f64 656c  Embeddings(model
-00001ae0: 3d22 6d6f 6465 6c73 2f65 6d62 6564 6469  ="models/embeddi
-00001af0: 6e67 2d30 3031 2229                      ng-001")
+00000000: 0d0a 6672 6f6d 206c 616e 6763 6861 696e  ..from langchain
+00000010: 2e6c 6c6d 7320 696d 706f 7274 2048 7567  .llms import Hug
+00000020: 6769 6e67 4661 6365 4875 620d 0a66 726f  gingFaceHub..fro
+00000030: 6d20 6c61 6e67 6368 6169 6e2e 656d 6265  m langchain.embe
+00000040: 6464 696e 6773 2e68 7567 6769 6e67 6661  ddings.huggingfa
+00000050: 6365 2069 6d70 6f72 7420 4875 6767 696e  ce import Huggin
+00000060: 6746 6163 6545 6d62 6564 6469 6e67 730d  gFaceEmbeddings.
+00000070: 0a66 726f 6d20 6c6c 616d 615f 696e 6465  .from llama_inde
+00000080: 782e 636f 7265 2069 6d70 6f72 7420 5665  x.core import Ve
+00000090: 6374 6f72 5374 6f72 6549 6e64 6578 0d0a  ctorStoreIndex..
+000000a0: 696d 706f 7274 2072 650d 0a69 6d70 6f72  import re..impor
+000000b0: 7420 6f73 0d0a 696d 706f 7274 206f 7065  t os..import ope
+000000c0: 6e61 690d 0a66 726f 6d20 6c6c 616d 615f  nai..from llama_
+000000d0: 696e 6465 782e 6c6c 6d73 2e6f 7065 6e61  index.llms.opena
+000000e0: 6920 696d 706f 7274 204f 7065 6e41 490d  i import OpenAI.
+000000f0: 0a66 726f 6d20 6c6c 616d 615f 696e 6465  .from llama_inde
+00000100: 782e 636f 7265 2069 6d70 6f72 7420 5665  x.core import Ve
+00000110: 6374 6f72 5374 6f72 6549 6e64 6578 0d0a  ctorStoreIndex..
+00000120: 6672 6f6d 206c 6c61 6d61 5f69 6e64 6578  from llama_index
+00000130: 2e6c 6c6d 732e 617a 7572 655f 6f70 656e  .llms.azure_open
+00000140: 6169 2069 6d70 6f72 7420 417a 7572 654f  ai import AzureO
+00000150: 7065 6e41 490d 0a66 726f 6d20 6c6c 616d  penAI..from llam
+00000160: 615f 696e 6465 782e 656d 6265 6464 696e  a_index.embeddin
+00000170: 6773 2e61 7a75 7265 5f6f 7065 6e61 6920  gs.azure_openai 
+00000180: 696d 706f 7274 2041 7a75 7265 4f70 656e  import AzureOpen
+00000190: 4149 456d 6265 6464 696e 670d 0a66 726f  AIEmbedding..fro
+000001a0: 6d20 6c6c 616d 615f 696e 6465 782e 636f  m llama_index.co
+000001b0: 7265 2069 6d70 6f72 7420 5665 6374 6f72  re import Vector
+000001c0: 5374 6f72 6549 6e64 6578 0d0a 6672 6f6d  StoreIndex..from
+000001d0: 206c 6c61 6d61 5f69 6e64 6578 2e63 6f72   llama_index.cor
+000001e0: 652e 7175 6572 795f 7069 7065 6c69 6e65  e.query_pipeline
+000001f0: 2069 6d70 6f72 7420 2851 7565 7279 5069   import (QueryPi
+00000200: 7065 6c69 6e65 2061 7320 5150 2c4c 696e  peline as QP,Lin
+00000210: 6b2c 496e 7075 7443 6f6d 706f 6e65 6e74  k,InputComponent
+00000220: 2c29 0d0a 6672 6f6d 206c 6c61 6d61 5f69  ,)..from llama_i
+00000230: 6e64 6578 2e65 7870 6572 696d 656e 7461  ndex.experimenta
+00000240: 6c2e 7175 6572 795f 656e 6769 6e65 2e70  l.query_engine.p
+00000250: 616e 6461 7320 696d 706f 7274 2050 616e  andas import Pan
+00000260: 6461 7349 6e73 7472 7563 7469 6f6e 5061  dasInstructionPa
+00000270: 7273 6572 0d0a 6672 6f6d 206c 6c61 6d61  rser..from llama
+00000280: 5f69 6e64 6578 2e63 6f72 6520 696d 706f  _index.core impo
+00000290: 7274 2050 726f 6d70 7454 656d 706c 6174  rt PromptTemplat
+000002a0: 650d 0a66 726f 6d20 6c6c 616d 615f 696e  e..from llama_in
+000002b0: 6465 782e 6c6c 6d73 2e61 7a75 7265 5f6f  dex.llms.azure_o
+000002c0: 7065 6e61 6920 696d 706f 7274 2041 7a75  penai import Azu
+000002d0: 7265 4f70 656e 4149 0d0a 0d0a 6465 6620  reOpenAI....def 
+000002e0: 656d 6265 645f 616e 645f 7275 6e5f 6d69  embed_and_run_mi
+000002f0: 7374 7261 6c28 646f 6375 6d65 6e74 7329  stral(documents)
+00000300: 3a0d 0a20 2020 200d 0a20 2020 2070 6174  :..    ..    pat
+00000310: 7465 726e 203d 2072 2241 6e73 7765 723a  tern = r"Answer:
+00000320: 2028 2e2a 2922 0d0a 2020 2020 7265 706f   (.*)"..    repo
+00000330: 5f69 6420 3d20 226d 6973 7472 616c 6169  _id = "mistralai
+00000340: 2f4d 6973 7472 616c 2d37 422d 496e 7374  /Mistral-7B-Inst
+00000350: 7275 6374 2d76 302e 3222 0d0a 2020 2020  ruct-v0.2"..    
+00000360: 6c6c 6d20 3d20 4875 6767 696e 6746 6163  llm = HuggingFac
+00000370: 6548 7562 2868 7567 6769 6e67 6661 6365  eHub(huggingface
+00000380: 6875 625f 6170 695f 746f 6b65 6e3d 2768  hub_api_token='h
+00000390: 665f 6e6b 6375 5647 4852 7a4e 6d46 7251  f_nkcuVGHRzNmFrQ
+000003a0: 6d63 5144 6654 7a6f 466e 454d 705a 6d55  mcQDfTzoFnEMpZmU
+000003b0: 4f4a 6e61 272c 0d0a 2020 2020 2020 2020  OJna',..        
+000003c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000003d0: 7265 706f 5f69 643d 7265 706f 5f69 642c  repo_id=repo_id,
+000003e0: 206d 6f64 656c 5f6b 7761 7267 733d 7b22   model_kwargs={"
+000003f0: 7465 6d70 6572 6174 7572 6522 3a30 2e35  temperature":0.5
+00000400: 2c20 226d 6178 5f6e 6577 5f74 6f6b 656e  , "max_new_token
+00000410: 7322 3a31 3030 7d29 0d0a 200d 0a20 2020  s":100}).. ..   
+00000420: 2065 6d62 6564 5f6d 6f64 656c 203d 2048   embed_model = H
+00000430: 7567 6769 6e67 4661 6365 456d 6265 6464  uggingFaceEmbedd
+00000440: 696e 6773 286d 6f64 656c 5f6e 616d 653d  ings(model_name=
+00000450: 2273 656e 7465 6e63 652d 7472 616e 7366  "sentence-transf
+00000460: 6f72 6d65 7273 2f61 6c6c 2d6d 706e 6574  ormers/all-mpnet
+00000470: 2d62 6173 652d 7632 2229 0d0a 2020 2020  -base-v2")..    
+00000480: 696e 6465 7820 3d20 5665 6374 6f72 5374  index = VectorSt
+00000490: 6f72 6549 6e64 6578 2e66 726f 6d5f 646f  oreIndex.from_do
+000004a0: 6375 6d65 6e74 7328 646f 6375 6d65 6e74  cuments(document
+000004b0: 732c 2065 6d62 6564 5f6d 6f64 656c 203d  s, embed_model =
+000004c0: 2065 6d62 6564 5f6d 6f64 656c 2c20 7368   embed_model, sh
+000004d0: 6f77 5f70 726f 6772 6573 733d 5472 7565  ow_progress=True
+000004e0: 290d 0a20 2020 2071 7565 7279 5f65 6e67  )..    query_eng
+000004f0: 696e 6520 3d20 696e 6465 782e 6173 5f71  ine = index.as_q
+00000500: 7565 7279 5f65 6e67 696e 6528 7369 6d69  uery_engine(simi
+00000510: 6c61 7269 7479 5f74 6f70 5f6b 3d33 2c6c  larity_top_k=3,l
+00000520: 6c6d 3d6c 6c6d 290d 0a20 2020 2077 6869  lm=llm)..    whi
+00000530: 6c65 2054 7275 653a 0d0a 2020 2020 2020  le True:..      
+00000540: 2020 7175 6572 7920 3d20 696e 7075 7428    query = input(
+00000550: 2251 7565 7279 3a22 290d 0a20 2020 2020  "Query:")..     
+00000560: 2020 2072 6573 706f 6e73 6520 3d20 7175     response = qu
+00000570: 6572 795f 656e 6769 6e65 2e71 7565 7279  ery_engine.query
+00000580: 2871 7565 7279 290d 0a20 2020 2020 2020  (query)..       
+00000590: 2072 6573 706f 6e73 6520 3d20 7374 7228   response = str(
+000005a0: 7265 7370 6f6e 7365 290d 0a20 2020 2020  response)..     
+000005b0: 2020 206d 6174 6368 203d 2072 652e 7365     match = re.se
+000005c0: 6172 6368 2870 6174 7465 726e 2c20 7265  arch(pattern, re
+000005d0: 7370 6f6e 7365 290d 0a20 2020 2020 2020  sponse)..       
+000005e0: 2061 6e73 7765 7220 3d20 6d61 7463 682e   answer = match.
+000005f0: 6772 6f75 7028 3129 0d0a 2020 2020 2020  group(1)..      
+00000600: 2020 7072 696e 7428 616e 7377 6572 290d    print(answer).
+00000610: 0a0d 0a64 6566 2065 6d62 6564 5f61 6e64  ...def embed_and
+00000620: 5f72 756e 5f6f 7065 6e61 6928 646f 6375  _run_openai(docu
+00000630: 6d65 6e74 7329 3a0d 0a20 2020 200d 0a20  ments):..    .. 
+00000640: 2020 206f 732e 656e 7669 726f 6e5b 224f     os.environ["O
+00000650: 5045 4e41 495f 4150 495f 4b45 5922 5d20  PENAI_API_KEY"] 
+00000660: 3d20 2273 6b2d 506c 366e 4c46 5a51 684d  = "sk-Pl6nLFZQhM
+00000670: 744f 4b6b 5933 354c 6872 5433 426c 626b  tOKkY35LhrT3Blbk
+00000680: 464a 7239 4a66 4433 5a70 4947 7470 6b46  FJr9JfD3ZpIGtpkF
+00000690: 3866 4a56 6362 220d 0a20 2020 206f 7065  8fJVcb"..    ope
+000006a0: 6e61 692e 6170 695f 6b65 7920 3d20 6f73  nai.api_key = os
+000006b0: 2e65 6e76 6972 6f6e 5b22 4f50 454e 4149  .environ["OPENAI
+000006c0: 5f41 5049 5f4b 4559 225d 0d0a 2020 2020  _API_KEY"]..    
+000006d0: 696e 6465 7820 3d20 5665 6374 6f72 5374  index = VectorSt
+000006e0: 6f72 6549 6e64 6578 2e66 726f 6d5f 646f  oreIndex.from_do
+000006f0: 6375 6d65 6e74 7328 646f 6375 6d65 6e74  cuments(document
+00000700: 732c 2073 686f 775f 7072 6f67 7265 7373  s, show_progress
+00000710: 3d54 7275 6529 232c 2065 6d62 6564 5f6d  =True)#, embed_m
+00000720: 6f64 656c 203d 2065 6d62 6564 5f6d 6f64  odel = embed_mod
+00000730: 656c 2c20 7368 6f77 5f70 726f 6772 6573  el, show_progres
+00000740: 733d 5472 7565 2c29 0d0a 2020 2020 6c6c  s=True,)..    ll
+00000750: 6d20 3d20 4f70 656e 4149 286d 6f64 656c  m = OpenAI(model
+00000760: 3d22 6770 742d 332e 352d 7475 7262 6f22  ="gpt-3.5-turbo"
+00000770: 290d 0a20 2020 2071 7565 7279 5f65 6e67  )..    query_eng
+00000780: 696e 6520 3d20 696e 6465 782e 6173 5f71  ine = index.as_q
+00000790: 7565 7279 5f65 6e67 696e 6528 7369 6d69  uery_engine(simi
+000007a0: 6c61 7269 7479 5f74 6f70 5f6b 3d33 2c6c  larity_top_k=3,l
+000007b0: 6c6d 3d6c 6c6d 290d 0a20 2020 2077 6869  lm=llm)..    whi
+000007c0: 6c65 2054 7275 653a 0d0a 2020 2020 2020  le True:..      
+000007d0: 2020 7175 6572 7920 3d20 696e 7075 7428    query = input(
+000007e0: 2251 7565 7279 3a22 290d 0a20 2020 2020  "Query:")..     
+000007f0: 2020 2072 6573 706f 6e73 6520 3d20 7175     response = qu
+00000800: 6572 795f 656e 6769 6e65 2e71 7565 7279  ery_engine.query
+00000810: 2871 7565 7279 290d 0a20 2020 2020 2020  (query)..       
+00000820: 2070 7269 6e74 2873 7472 2872 6573 706f   print(str(respo
+00000830: 6e73 6529 290d 0a20 2020 200d 0a0d 0a64  nse))..    ....d
+00000840: 6566 2065 6d62 6564 5f61 6e64 5f72 756e  ef embed_and_run
+00000850: 5f61 7a75 7265 6f70 656e 6169 2864 6f63  _azureopenai(doc
+00000860: 756d 656e 7473 293a 0d0a 2020 2020 0d0a  uments):..    ..
+00000870: 0d0a 0d0a 0d0a 2020 2020 6170 695f 6b65  ......    api_ke
+00000880: 793d 2022 3137 6231 3563 3963 3063 3336  y= "17b15c9c0c36
+00000890: 3433 3336 3862 6238 6539 6532 6335 6164  43368bb8e9e2c5ad
+000008a0: 6130 3666 2220 0d0a 2020 2020 6170 695f  a06f" ..    api_
+000008b0: 7665 7273 696f 6e3d 2232 3032 332d 3037  version="2023-07
+000008c0: 2d30 312d 7072 6576 6965 7722 0d0a 2020  -01-preview"..  
+000008d0: 2020 617a 7572 655f 656e 6470 6f69 6e74    azure_endpoint
+000008e0: 3d22 6874 7470 733a 2f2f 636f 7661 6c65  ="https://covale
+000008f0: 6e73 656f 7065 6e61 6965 6173 7475 7332  nseopenaieastus2
+00000900: 2e6f 7065 6e61 692e 617a 7572 652e 636f  .openai.azure.co
+00000910: 6d2f 220d 0a0d 0a20 2020 206c 6c6d 203d  m/"....    llm =
+00000920: 2041 7a75 7265 4f70 656e 4149 280d 0a20   AzureOpenAI(.. 
+00000930: 2020 2020 2020 206d 6f64 656c 3d22 6770         model="gp
+00000940: 742d 3335 2d74 7572 626f 2d31 366b 222c  t-35-turbo-16k",
+00000950: 0d0a 2020 2020 2020 2020 6465 706c 6f79  ..        deploy
+00000960: 6d65 6e74 5f6e 616d 653d 2267 7074 2d33  ment_name="gpt-3
+00000970: 352d 7475 7262 6f2d 3136 6b22 2c0d 0a20  5-turbo-16k",.. 
+00000980: 2020 2020 2020 2061 7069 5f6b 6579 3d61         api_key=a
+00000990: 7069 5f6b 6579 2c0d 0a20 2020 2020 2020  pi_key,..       
+000009a0: 2061 7a75 7265 5f65 6e64 706f 696e 743d   azure_endpoint=
+000009b0: 617a 7572 655f 656e 6470 6f69 6e74 2c0d  azure_endpoint,.
+000009c0: 0a20 2020 2020 2020 2061 7069 5f76 6572  .        api_ver
+000009d0: 7369 6f6e 3d61 7069 5f76 6572 7369 6f6e  sion=api_version
+000009e0: 2c0d 0a20 2020 2029 0d0a 0d0a 2020 2020  ,..    )....    
+000009f0: 2320 596f 7520 6e65 6564 2074 6f20 6465  # You need to de
+00000a00: 706c 6f79 2079 6f75 7220 6f77 6e20 656d  ploy your own em
+00000a10: 6265 6464 696e 6720 6d6f 6465 6c20 6173  bedding model as
+00000a20: 2077 656c 6c20 6173 2079 6f75 7220 6f77   well as your ow
+00000a30: 6e20 6368 6174 2063 6f6d 706c 6574 696f  n chat completio
+00000a40: 6e20 6d6f 6465 6c0d 0a20 2020 2065 6d62  n model..    emb
+00000a50: 6564 5f6d 6f64 656c 203d 2041 7a75 7265  ed_model = Azure
+00000a60: 4f70 656e 4149 456d 6265 6464 696e 6728  OpenAIEmbedding(
+00000a70: 0d0a 2020 2020 2020 2020 6d6f 6465 6c3d  ..        model=
+00000a80: 2274 6578 742d 656d 6265 6464 696e 672d  "text-embedding-
+00000a90: 6164 612d 3030 3222 2c0d 0a20 2020 2020  ada-002",..     
+00000aa0: 2020 2064 6570 6c6f 796d 656e 745f 6e61     deployment_na
+00000ab0: 6d65 3d22 7465 7874 2d65 6d62 6564 6469  me="text-embeddi
+00000ac0: 6e67 2d61 6461 2d30 3032 222c 0d0a 2020  ng-ada-002",..  
+00000ad0: 2020 2020 2020 6170 695f 6b65 793d 6170        api_key=ap
+00000ae0: 695f 6b65 792c 0d0a 2020 2020 2020 2020  i_key,..        
+00000af0: 617a 7572 655f 656e 6470 6f69 6e74 3d61  azure_endpoint=a
+00000b00: 7a75 7265 5f65 6e64 706f 696e 742c 0d0a  zure_endpoint,..
+00000b10: 2020 2020 2020 2020 6170 695f 7665 7273          api_vers
+00000b20: 696f 6e3d 6170 695f 7665 7273 696f 6e2c  ion=api_version,
+00000b30: 0d0a 2020 2020 290d 0a0d 0a20 2020 2066  ..    )....    f
+00000b40: 726f 6d20 6c6c 616d 615f 696e 6465 782e  rom llama_index.
+00000b50: 636f 7265 2069 6d70 6f72 7420 5365 7474  core import Sett
+00000b60: 696e 6773 0d0a 2020 2020 5365 7474 696e  ings..    Settin
+00000b70: 6773 2e6c 6c6d 203d 206c 6c6d 0d0a 2020  gs.llm = llm..  
+00000b80: 2020 5365 7474 696e 6773 2e65 6d62 6564    Settings.embed
+00000b90: 5f6d 6f64 656c 203d 2065 6d62 6564 5f6d  _model = embed_m
+00000ba0: 6f64 656c 0d0a 0d0a 2020 2020 696e 6465  odel....    inde
+00000bb0: 7820 3d20 5665 6374 6f72 5374 6f72 6549  x = VectorStoreI
+00000bc0: 6e64 6578 2e66 726f 6d5f 646f 6375 6d65  ndex.from_docume
+00000bd0: 6e74 7328 646f 6375 6d65 6e74 732c 2073  nts(documents, s
+00000be0: 686f 775f 7072 6f67 7265 7373 3d54 7275  how_progress=Tru
+00000bf0: 6529 232c 2065 6d62 6564 5f6d 6f64 656c  e)#, embed_model
+00000c00: 203d 2065 6d62 6564 5f6d 6f64 656c 2c20   = embed_model, 
+00000c10: 7368 6f77 5f70 726f 6772 6573 733d 5472  show_progress=Tr
+00000c20: 7565 2c29 0d0a 2020 2020 7175 6572 795f  ue,)..    query_
+00000c30: 656e 6769 6e65 203d 2069 6e64 6578 2e61  engine = index.a
+00000c40: 735f 7175 6572 795f 656e 6769 6e65 2873  s_query_engine(s
+00000c50: 696d 696c 6172 6974 795f 746f 705f 6b3d  imilarity_top_k=
+00000c60: 332c 6c6c 6d3d 6c6c 6d29 0d0a 2020 2020  3,llm=llm)..    
+00000c70: 7768 696c 6520 5472 7565 3a0d 0a20 2020  while True:..   
+00000c80: 2020 2020 2071 7565 7279 203d 2069 6e70       query = inp
+00000c90: 7574 2822 5175 6572 793a 2229 0d0a 2020  ut("Query:")..  
+00000ca0: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
+00000cb0: 2071 7565 7279 5f65 6e67 696e 652e 7175   query_engine.qu
+00000cc0: 6572 7928 7175 6572 7929 0d0a 2020 2020  ery(query)..    
+00000cd0: 2020 2020 7072 696e 7428 7374 7228 7265      print(str(re
+00000ce0: 7370 6f6e 7365 2929 0d0a 0d0a 6465 6620  sponse))....def 
+00000cf0: 6373 765f 656e 6769 6e65 2864 6629 3a0d  csv_engine(df):.
+00000d00: 0a20 2020 2070 7269 6e74 2864 6629 0d0a  .    print(df)..
+00000d10: 2020 2020 0d0a 0d0a 2020 2020 6170 695f      ....    api_
+00000d20: 6b65 793d 2022 3137 6231 3563 3963 3063  key= "17b15c9c0c
+00000d30: 3336 3433 3336 3862 6238 6539 6532 6335  3643368bb8e9e2c5
+00000d40: 6164 6130 3666 2220 0d0a 2020 2020 6170  ada06f" ..    ap
+00000d50: 695f 7665 7273 696f 6e3d 2232 3032 332d  i_version="2023-
+00000d60: 3037 2d30 312d 7072 6576 6965 7722 0d0a  07-01-preview"..
+00000d70: 2020 2020 617a 7572 655f 656e 6470 6f69      azure_endpoi
+00000d80: 6e74 3d22 6874 7470 733a 2f2f 636f 7661  nt="https://cova
+00000d90: 6c65 6e73 656f 7065 6e61 6965 6173 7475  lenseopenaieastu
+00000da0: 7332 2e6f 7065 6e61 692e 617a 7572 652e  s2.openai.azure.
+00000db0: 636f 6d2f 220d 0a0d 0a20 2020 206c 6c6d  com/"....    llm
+00000dc0: 203d 2041 7a75 7265 4f70 656e 4149 280d   = AzureOpenAI(.
+00000dd0: 0a20 2020 2020 2020 206d 6f64 656c 3d22  .        model="
+00000de0: 6770 742d 3335 2d74 7572 626f 2d31 366b  gpt-35-turbo-16k
+00000df0: 222c 0d0a 2020 2020 2020 2020 6465 706c  ",..        depl
+00000e00: 6f79 6d65 6e74 5f6e 616d 653d 2267 7074  oyment_name="gpt
+00000e10: 2d33 352d 7475 7262 6f2d 3136 6b22 2c0d  -35-turbo-16k",.
+00000e20: 0a20 2020 2020 2020 2061 7069 5f6b 6579  .        api_key
+00000e30: 3d61 7069 5f6b 6579 2c0d 0a20 2020 2020  =api_key,..     
+00000e40: 2020 2061 7a75 7265 5f65 6e64 706f 696e     azure_endpoin
+00000e50: 743d 617a 7572 655f 656e 6470 6f69 6e74  t=azure_endpoint
+00000e60: 2c0d 0a20 2020 2020 2020 2061 7069 5f76  ,..        api_v
+00000e70: 6572 7369 6f6e 3d61 7069 5f76 6572 7369  ersion=api_versi
+00000e80: 6f6e 2c0d 0a20 2020 2029 0d0a 0d0a 2020  on,..    )....  
+00000e90: 2020 696e 7374 7275 6374 696f 6e5f 7374    instruction_st
+00000ea0: 7220 3d20 280d 0a20 2020 2022 312e 2043  r = (..    "1. C
+00000eb0: 6f6e 7665 7274 2074 6865 2071 7565 7279  onvert the query
+00000ec0: 2074 6f20 6578 6563 7574 6162 6c65 2050   to executable P
+00000ed0: 7974 686f 6e20 636f 6465 2075 7369 6e67  ython code using
+00000ee0: 2050 616e 6461 732e 5c6e 220d 0a20 2020   Pandas.\n"..   
+00000ef0: 2022 322e 2054 6865 2066 696e 616c 206c   "2. The final l
+00000f00: 696e 6520 6f66 2063 6f64 6520 7368 6f75  ine of code shou
+00000f10: 6c64 2062 6520 6120 5079 7468 6f6e 2065  ld be a Python e
+00000f20: 7870 7265 7373 696f 6e20 7468 6174 2063  xpression that c
+00000f30: 616e 2062 6520 6361 6c6c 6564 2077 6974  an be called wit
+00000f40: 6820 7468 6520 6065 7661 6c28 2960 2066  h the `eval()` f
+00000f50: 756e 6374 696f 6e2e 5c6e 220d 0a20 2020  unction.\n"..   
+00000f60: 2022 332e 2054 6865 2063 6f64 6520 7368   "3. The code sh
+00000f70: 6f75 6c64 2072 6570 7265 7365 6e74 2061  ould represent a
+00000f80: 2073 6f6c 7574 696f 6e20 746f 2074 6865   solution to the
+00000f90: 2071 7565 7279 2e5c 6e22 0d0a 2020 2020   query.\n"..    
+00000fa0: 2234 2e20 5052 494e 5420 4f4e 4c59 2054  "4. PRINT ONLY T
+00000fb0: 4845 2045 5850 5245 5353 494f 4e2e 5c6e  HE EXPRESSION.\n
+00000fc0: 220d 0a20 2020 2022 352e 2044 6f20 6e6f  "..    "5. Do no
+00000fd0: 7420 7175 6f74 6520 7468 6520 6578 7072  t quote the expr
+00000fe0: 6573 7369 6f6e 2e5c 6e22 0d0a 2020 2020  ession.\n"..    
+00000ff0: 6622 362e 2053 7472 6963 746c 7920 7573  f"6. Strictly us
+00001000: 6520 636f 6c75 6d6e 206e 616d 6573 206d  e column names m
+00001010: 656e 7469 6f6e 6564 2062 656c 6f77 207b  entioned below {
+00001020: 6466 2e68 6561 6428 3129 7d22 290d 0a0d  df.head(1)}")...
+00001030: 0a20 2020 2070 616e 6461 735f 7072 6f6d  .    pandas_prom
+00001040: 7074 5f73 7472 203d 2028 0d0a 2020 2020  pt_str = (..    
+00001050: 2020 2020 2259 6f75 2061 7265 2077 6f72      "You are wor
+00001060: 6b69 6e67 2077 6974 6820 6120 7061 6e64  king with a pand
+00001070: 6173 2064 6174 6166 7261 6d65 2069 6e20  as dataframe in 
+00001080: 5079 7468 6f6e 2e5c 6e22 0d0a 2020 2020  Python.\n"..    
+00001090: 2020 2020 2254 6865 206e 616d 6520 6f66      "The name of
+000010a0: 2074 6865 2064 6174 6166 7261 6d65 2069   the dataframe i
+000010b0: 7320 6064 6660 2e5c 6e22 0d0a 2020 2020  s `df`.\n"..    
+000010c0: 2020 2020 2254 6869 7320 6973 2074 6865      "This is the
+000010d0: 2072 6573 756c 7420 6f66 2060 7072 696e   result of `prin
+000010e0: 7428 6466 2e68 6561 6428 2929 603a 5c6e  t(df.head())`:\n
+000010f0: 220d 0a20 2020 2020 2020 2022 7b64 665f  "..        "{df_
+00001100: 7374 727d 5c6e 5c6e 220d 0a20 2020 2020  str}\n\n"..     
+00001110: 2020 2022 466f 6c6c 6f77 2074 6865 7365     "Follow these
+00001120: 2069 6e73 7472 7563 7469 6f6e 733a 5c6e   instructions:\n
+00001130: 220d 0a20 2020 2020 2020 2022 7b69 6e73  "..        "{ins
+00001140: 7472 7563 7469 6f6e 5f73 7472 7d5c 6e22  truction_str}\n"
+00001150: 0d0a 2020 2020 2020 2020 2251 7565 7279  ..        "Query
+00001160: 3a20 7b71 7565 7279 5f73 7472 7d5c 6e5c  : {query_str}\n\
+00001170: 6e22 0d0a 2020 2020 2020 2020 2245 7870  n"..        "Exp
+00001180: 7265 7373 696f 6e3a 2229 0d0a 2020 2020  ression:")..    
+00001190: 0d0a 2020 2020 7265 7370 6f6e 7365 5f73  ..    response_s
+000011a0: 796e 7468 6573 6973 5f70 726f 6d70 745f  ynthesis_prompt_
+000011b0: 7374 7220 3d20 280d 0a20 2020 2020 2020  str = (..       
+000011c0: 2022 4769 7665 6e20 616e 2069 6e70 7574   "Given an input
+000011d0: 2071 7565 7374 696f 6e2c 2073 796e 7468   question, synth
+000011e0: 6573 697a 6520 6120 7265 7370 6f6e 7365  esize a response
+000011f0: 2066 726f 6d20 7468 6520 7175 6572 7920   from the query 
+00001200: 7265 7375 6c74 732e 5c6e 220d 0a20 2020  results.\n"..   
+00001210: 2020 2020 2022 5175 6572 793a 207b 7175       "Query: {qu
+00001220: 6572 795f 7374 727d 5c6e 5c6e 220d 0a20  ery_str}\n\n".. 
+00001230: 2020 2020 2020 2022 5061 6e64 6173 2049         "Pandas I
+00001240: 6e73 7472 7563 7469 6f6e 7320 286f 7074  nstructions (opt
+00001250: 696f 6e61 6c29 3a5c 6e7b 7061 6e64 6173  ional):\n{pandas
+00001260: 5f69 6e73 7472 7563 7469 6f6e 737d 5c6e  _instructions}\n
+00001270: 5c6e 220d 0a20 2020 2020 2020 2022 5061  \n"..        "Pa
+00001280: 6e64 6173 204f 7574 7075 743a 207b 7061  ndas Output: {pa
+00001290: 6e64 6173 5f6f 7574 7075 747d 5c6e 5c6e  ndas_output}\n\n
+000012a0: 220d 0a20 2020 2020 2020 2022 5265 7370  "..        "Resp
+000012b0: 6f6e 7365 3a20 2229 0d0a 0d0a 2020 2020  onse: ")....    
+000012c0: 7061 6e64 6173 5f70 726f 6d70 7420 3d20  pandas_prompt = 
+000012d0: 5072 6f6d 7074 5465 6d70 6c61 7465 2870  PromptTemplate(p
+000012e0: 616e 6461 735f 7072 6f6d 7074 5f73 7472  andas_prompt_str
+000012f0: 292e 7061 7274 6961 6c5f 666f 726d 6174  ).partial_format
+00001300: 280d 0a20 2020 2020 2020 2069 6e73 7472  (..        instr
+00001310: 7563 7469 6f6e 5f73 7472 3d69 6e73 7472  uction_str=instr
+00001320: 7563 7469 6f6e 5f73 7472 2c20 6466 5f73  uction_str, df_s
+00001330: 7472 3d64 662e 6865 6164 2835 2929 0d0a  tr=df.head(5))..
+00001340: 2020 2020 0d0a 2020 2020 7061 6e64 6173      ..    pandas
+00001350: 5f6f 7574 7075 745f 7061 7273 6572 203d  _output_parser =
+00001360: 2050 616e 6461 7349 6e73 7472 7563 7469   PandasInstructi
+00001370: 6f6e 5061 7273 6572 2864 6629 0d0a 2020  onParser(df)..  
+00001380: 2020 7265 7370 6f6e 7365 5f73 796e 7468    response_synth
+00001390: 6573 6973 5f70 726f 6d70 7420 3d20 5072  esis_prompt = Pr
+000013a0: 6f6d 7074 5465 6d70 6c61 7465 2872 6573  omptTemplate(res
+000013b0: 706f 6e73 655f 7379 6e74 6865 7369 735f  ponse_synthesis_
+000013c0: 7072 6f6d 7074 5f73 7472 290d 0a20 2020  prompt_str)..   
+000013d0: 2023 206c 6c6d 203d 204f 7065 6e41 4928   # llm = OpenAI(
+000013e0: 6d6f 6465 6c3d 2267 7074 2d33 2e35 2d74  model="gpt-3.5-t
+000013f0: 7572 626f 2229 0d0a 0d0a 2020 2020 7170  urbo")....    qp
+00001400: 203d 2051 5028 0d0a 2020 2020 6d6f 6475   = QP(..    modu
+00001410: 6c65 733d 7b0d 0a20 2020 2020 2020 2022  les={..        "
+00001420: 696e 7075 7422 3a20 496e 7075 7443 6f6d  input": InputCom
+00001430: 706f 6e65 6e74 2829 2c0d 0a20 2020 2020  ponent(),..     
+00001440: 2020 2022 7061 6e64 6173 5f70 726f 6d70     "pandas_promp
+00001450: 7422 3a20 7061 6e64 6173 5f70 726f 6d70  t": pandas_promp
+00001460: 742c 0d0a 2020 2020 2020 2020 226c 6c6d  t,..        "llm
+00001470: 3122 3a20 6c6c 6d2c 0d0a 2020 2020 2020  1": llm,..      
+00001480: 2020 2270 616e 6461 735f 6f75 7470 7574    "pandas_output
+00001490: 5f70 6172 7365 7222 3a20 7061 6e64 6173  _parser": pandas
+000014a0: 5f6f 7574 7075 745f 7061 7273 6572 2c0d  _output_parser,.
+000014b0: 0a20 2020 2020 2020 2022 7265 7370 6f6e  .        "respon
+000014c0: 7365 5f73 796e 7468 6573 6973 5f70 726f  se_synthesis_pro
+000014d0: 6d70 7422 3a20 7265 7370 6f6e 7365 5f73  mpt": response_s
+000014e0: 796e 7468 6573 6973 5f70 726f 6d70 742c  ynthesis_prompt,
+000014f0: 0d0a 2020 2020 2020 2020 226c 6c6d 3222  ..        "llm2"
+00001500: 3a20 6c6c 6d2c 0d0a 2020 2020 7d2c 0d0a  : llm,..    },..
+00001510: 2020 2020 7665 7262 6f73 653d 5472 7565      verbose=True
+00001520: 2c0d 0a20 2020 2029 0d0a 2020 2020 7170  ,..    )..    qp
+00001530: 2e61 6464 5f63 6861 696e 285b 2269 6e70  .add_chain(["inp
+00001540: 7574 222c 2022 7061 6e64 6173 5f70 726f  ut", "pandas_pro
+00001550: 6d70 7422 2c20 226c 6c6d 3122 2c20 2270  mpt", "llm1", "p
+00001560: 616e 6461 735f 6f75 7470 7574 5f70 6172  andas_output_par
+00001570: 7365 7222 5d29 0d0a 2020 2020 7170 2e61  ser"])..    qp.a
+00001580: 6464 5f6c 696e 6b73 280d 0a20 2020 2020  dd_links(..     
+00001590: 2020 205b 0d0a 2020 2020 2020 2020 2020     [..          
+000015a0: 2020 4c69 6e6b 2822 696e 7075 7422 2c20    Link("input", 
+000015b0: 2272 6573 706f 6e73 655f 7379 6e74 6865  "response_synthe
+000015c0: 7369 735f 7072 6f6d 7074 222c 2064 6573  sis_prompt", des
+000015d0: 745f 6b65 793d 2271 7565 7279 5f73 7472  t_key="query_str
+000015e0: 2229 2c0d 0a20 2020 2020 2020 2020 2020  "),..           
+000015f0: 204c 696e 6b28 0d0a 2020 2020 2020 2020   Link(..        
+00001600: 2020 2020 2020 2020 226c 6c6d 3122 2c20          "llm1", 
+00001610: 2272 6573 706f 6e73 655f 7379 6e74 6865  "response_synthe
+00001620: 7369 735f 7072 6f6d 7074 222c 2064 6573  sis_prompt", des
+00001630: 745f 6b65 793d 2270 616e 6461 735f 696e  t_key="pandas_in
+00001640: 7374 7275 6374 696f 6e73 220d 0a20 2020  structions"..   
+00001650: 2020 2020 2020 2020 2029 2c0d 0a20 2020           ),..   
+00001660: 2020 2020 2020 2020 204c 696e 6b28 0d0a           Link(..
+00001670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001680: 2270 616e 6461 735f 6f75 7470 7574 5f70  "pandas_output_p
+00001690: 6172 7365 7222 2c0d 0a20 2020 2020 2020  arser",..       
+000016a0: 2020 2020 2020 2020 2022 7265 7370 6f6e           "respon
+000016b0: 7365 5f73 796e 7468 6573 6973 5f70 726f  se_synthesis_pro
+000016c0: 6d70 7422 2c0d 0a20 2020 2020 2020 2020  mpt",..         
+000016d0: 2020 2020 2020 2064 6573 745f 6b65 793d         dest_key=
+000016e0: 2270 616e 6461 735f 6f75 7470 7574 222c  "pandas_output",
+000016f0: 0d0a 2020 2020 2020 2020 2020 2020 292c  ..            ),
+00001700: 0d0a 2020 2020 2020 2020 5d0d 0a20 2020  ..        ]..   
+00001710: 2029 0d0a 2020 2020 2320 6164 6420 6c69   )..    # add li
+00001720: 6e6b 2066 726f 6d20 7265 7370 6f6e 7365  nk from response
+00001730: 2073 796e 7468 6573 6973 2070 726f 6d70   synthesis promp
+00001740: 7420 746f 206c 6c6d 320d 0a20 2020 2071  t to llm2..    q
+00001750: 702e 6164 645f 6c69 6e6b 2822 7265 7370  p.add_link("resp
+00001760: 6f6e 7365 5f73 796e 7468 6573 6973 5f70  onse_synthesis_p
+00001770: 726f 6d70 7422 2c20 226c 6c6d 3222 290d  rompt", "llm2").
+00001780: 0a0d 0a20 2020 2077 6869 6c65 2054 7275  ...    while Tru
+00001790: 653a 0d0a 2020 2020 2020 2020 7175 6572  e:..        quer
+000017a0: 795f 7374 7220 3d20 696e 7075 7428 2251  y_str = input("Q
+000017b0: 7565 7279 3a22 290d 0a20 2020 2020 2020  uery:")..       
+000017c0: 2072 6573 706f 6e73 6520 3d20 7170 2e72   response = qp.r
+000017d0: 756e 2871 7565 7279 5f73 7472 3d71 7565  un(query_str=que
+000017e0: 7279 5f73 7472 2c29 0d0a 2020 2020 2020  ry_str,)..      
+000017f0: 2020 7072 696e 7428 7265 7370 6f6e 7365    print(response
+00001800: 2e6d 6573 7361 6765 2e63 6f6e 7465 6e74  .message.content
+00001810: 290d 0a0d 0a64 6566 2065 6d62 6564 5f61  )....def embed_a
+00001820: 6e64 5f72 756e 2865 6d62 6564 6469 6e67  nd_run(embedding
+00001830: 7329 3a0d 0a20 2020 2077 6869 6c65 2054  s):..    while T
+00001840: 7275 653a 0d0a 2020 2020 2020 2020 6368  rue:..        ch
+00001850: 6f69 6365 203d 2069 6e70 7574 2822 506c  oice = input("Pl
+00001860: 6561 7365 2063 686f 6f73 6520 7468 6520  ease choose the 
+00001870: 7072 6566 6572 6564 2065 6e67 696e 653a  prefered engine:
+00001880: 205c 6e31 2e20 417a 7572 6520 4f70 656e   \n1. Azure Open
+00001890: 6169 205c 6e32 2e4d 6973 7472 616c 2d41  ai \n2.Mistral-A
+000018a0: 6920 5c6e 332e 4353 5620 656e 6769 6e65  i \n3.CSV engine
+000018b0: 5c6e 2059 6f75 7220 4368 6f69 6365 2028  \n Your Choice (
+000018c0: 312f 322f 3329 3a20 2229 0d0a 2020 2020  1/2/3): ")..    
+000018d0: 2020 2020 6966 2063 686f 6963 6520 3d3d      if choice ==
+000018e0: 2027 3127 3a0d 0a20 2020 2020 2020 2020   '1':..         
+000018f0: 2020 2065 6d62 6564 5f61 6e64 5f72 756e     embed_and_run
+00001900: 5f61 7a75 7265 6f70 656e 6169 2865 6d62  _azureopenai(emb
+00001910: 6564 6469 6e67 7329 0d0a 2020 2020 2020  eddings)..      
+00001920: 2020 656c 6966 2063 686f 6963 6520 3d3d    elif choice ==
+00001930: 2027 3227 3a0d 0a20 2020 2020 2020 2020   '2':..         
+00001940: 2020 2065 6d62 6564 5f61 6e64 5f72 756e     embed_and_run
+00001950: 5f6d 6973 7472 616c 2865 6d62 6564 6469  _mistral(embeddi
+00001960: 6e67 7329 0d0a 2020 2020 2020 2020 656c  ngs)..        el
+00001970: 6966 2063 686f 6963 6520 3d3d 2027 3327  if choice == '3'
+00001980: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
+00001990: 7376 5f65 6e67 696e 6528 656d 6265 6464  sv_engine(embedd
+000019a0: 696e 6773 290d 0a20 2020 2020 2020 2065  ings)..        e
+000019b0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+000019c0: 2020 7072 696e 7428 2270 6c65 6173 6520    print("please 
+000019d0: 6368 6f6f 7365 206f 6e65 206f 6620 7468  choose one of th
+000019e0: 6520 6f70 7469 6f6e 7320 6d65 6e74 696f  e options mentio
+000019f0: 6e65 6422 290d 0a0d 0a0d 0a0d 0a         ned")........
```

## Comparing `lense/_data_load/loader.py` & `lense/_chat/loader.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,23 +1,24 @@
 
 # pip install PyPDF2
 # pip install python-docx
 # pip install python-pptx
 # pip install llama_index
-
+import warnings
+warnings.filterwarnings('ignore')
 import pandas as pd
 from PyPDF2 import PdfReader
 from docx import Document
 from pptx import Presentation
 import pathlib
 import warnings
 from llama_index.core import SimpleDirectoryReader, Document
 from llama_index.readers.file import PyMuPDFReader
-from lense._data_load.error_handling import *
-from lense._data_load.replace_file import *
+from lense._chat.error_handling import *
+from lense._chat.replace_file import *
 
 def load_csv(file_path):
 
     try:
         data = pd.read_csv(file_path)
         error_score = error_handling(data)
         print("error_score:",error_score)
```

## Comparing `lense/_data_load/replace_file.py` & `lense/_chat/replace_file.py`

 * *Files identical despite different names*

